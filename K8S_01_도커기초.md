# í•µì‹¬ë§Œ ì½• ì¿ ë²„ë„¤í‹°ìŠ¤ 
* ë¹„ì œì´í¼ë¸”ë¦­ : https://github.com/bjpublic/core_kubernetes 

## A. WSL(ubuntu)í™˜ê²½ì—ì„œ ì‹¤ìŠµ

ğŸ“˜ Common WSL Commands & Options
ğŸ”¹ Launch & Use
| Command / Option       | Description                                                            |
| ---------------------- | ---------------------------------------------------------------------- |
| `wsl`                  | Launch the default WSL distribution                                    |
| `wsl <command>`        | Run a Linux command from PowerShell or CMD (e.g. `wsl ls -la`)         |
| `wsl -d <distro>`      | Launch a specific distribution (e.g. `wsl -d Ubuntu-22.04`)            |
| `wsl -e <command>`     | Use a custom entry point or command (Windows 11+, alternative to `-c`) |
| `wsl --exec <command>` | Alias for `-e`, more readable                                          |

ğŸ”¹ Distribution Management
| Command / Option                                    | Description                                               |                                                   |
| --------------------------------------------------- | --------------------------------------------------------- | ------------------------------------------------- |
| `wsl --list` or `-l`                                | List installed WSL distributions                          |                                                   |
| `wsl --list --verbose` or `-l -v`                   | Show distro name, state, and WSL version                  |                                                   |
| `wsl --set-default <distro>`                        | Set the default distro (used when you just type `wsl`)    |                                                   |
| \`wsl --set-version <distro> <1                     | 2>\`                                                      | Convert distro between WSL 1 and WSL 2            |
| \`wsl --set-default-version <1                      | 2>\`                                                      | Set WSL 1 or 2 as the default for future installs |
| `wsl --unregister <distro>`                         | Uninstall (delete) a distribution completely              |                                                   |
| `wsl --import <name> <install-location> <tar-file>` | Import a distro from a `.tar` rootfs                      |                                                   |
| `wsl --export <distro> <file.tar>`                  | Export a distro to a `.tar` file (for backup, move, etc.) |                                                   |

ğŸ”¹ Configuration & Installation
| Command / Option            | Description                                                              |
| --------------------------- | ------------------------------------------------------------------------ |
| `wsl --install`             | Install WSL with default settings (WSL 2 + Ubuntu) â€” Windows 10 21H2+/11 |
| `wsl --install -d <distro>` | Install a specific distro from Microsoft Store                           |
| `wsl --update`              | Update the WSL kernel                                                    |
| `wsl --status`              | Show system WSL info (default version, kernel version, etc.)             |
| `wsl --help`                | Show help for WSL commands                                               |



### 1. ë„ì»¤ê¸°ì´ˆ

#### 1.1 ë„ì»¤ì„¤ì¹˜
* rootê¶Œí•œì¼ ê²½ìš° sudo ëª…ë ¹ ì œê±°

âœ… í˜„ì¬ ì‚¬ìš©ì í™•ì¸ ëª…ë ¹ì–´
| ëª…ë ¹ì–´          | ì„¤ëª…                                  | ì˜ˆì‹œ ì¶œë ¥                                          |
| ------------ | ----------------------------------- | ---------------------------------------------- |
| `whoami`     | í˜„ì¬ ë¡œê·¸ì¸í•œ ì‚¬ìš©ì ì´ë¦„ë§Œ ì¶œë ¥                  | `ubuntu`                                       |
| `id -un`     | í˜„ì¬ ì‚¬ìš©ìì˜ ì´ë¦„ ì¶œë ¥ (`whoami`ê³¼ ìœ ì‚¬)        | `ubuntu`                                       |
| `echo $USER` | `$USER` í™˜ê²½ ë³€ìˆ˜ì— ì €ì¥ëœ ì‚¬ìš©ì ì´ë¦„ ì¶œë ¥        | `ubuntu`                                       |
| `id`         | í˜„ì¬ ì‚¬ìš©ìì˜ UID, GID, ê·¸ë£¹ ë“± ì •ë³´ ì¶œë ¥        | `uid=1000(ubuntu) gid=1000(ubuntu) groups=...` |
| `logname`    | ë¡œê·¸ì¸ ì‹œ ì‚¬ìš©ëœ ì‚¬ìš©ì ì´ë¦„ (su/sudoì™€ ë‹¤ë¥¼ ìˆ˜ ìˆìŒ) | `ubuntu`                                       |

```bash
# docker.io: Ubuntu ì €ì¥ì†Œì— ìˆëŠ” Docker ì—”ì§„ íŒ¨í‚¤ì§€ë¥¼ ì„¤ì¹˜í•©ë‹ˆë‹¤.
# net-tools: ifconfig, netstat ë“± ë„¤íŠ¸ì›Œí¬ ë„êµ¬ë¥¼ í¬í•¨í•œ íŒ¨í‚¤ì§€
sudo apt update && sudo apt install -y docker.io net-tools
```
ğŸ§¾ sudo usermod -aG docker $USER ì˜µì…˜ 
| êµ¬ì„± ìš”ì†Œ       | ì˜ë¯¸ ë° ì„¤ëª…                                          |
| ----------- | ------------------------------------------------ |
| `sudo`      | ê´€ë¦¬ì ê¶Œí•œìœ¼ë¡œ ëª…ë ¹ì–´ ì‹¤í–‰                                  |
| `usermod`   | ë¦¬ëˆ…ìŠ¤ ì‚¬ìš©ìì˜ ì†ì„±(ê·¸ë£¹, ì‰˜ ë“±)ì„ ìˆ˜ì •í•˜ëŠ” ëª…ë ¹ì–´                   |
| `-a`        | `append`ì˜ ì¤„ì„ë§. ê¸°ì¡´ ê·¸ë£¹ì„ **ìœ ì§€í•œ ì±„ë¡œ** ìƒˆ ê·¸ë£¹ì— ì¶”ê°€í•¨       |
| `-G docker` | ì‚¬ìš©ìë¥¼ `docker` ê·¸ë£¹ì— ì¶”ê°€í•¨                            |
| `$USER`     | í˜„ì¬ ë¡œê·¸ì¸í•œ ì‚¬ìš©ì ì´ë¦„ì„ ë‚˜íƒ€ë‚´ëŠ” í™˜ê²½ ë³€ìˆ˜ (`echo $USER`ë¡œ í™•ì¸ ê°€ëŠ¥) |

```bash
# Dockerë¥¼ ë¹„root ì‚¬ìš©ìë¡œ ì‹¤í–‰í•  ìˆ˜ ìˆë„ë¡ ê¶Œí•œì„ ë¶€ì—¬í•˜ëŠ” ëª…ë ¹
sudo usermod -aG docker $USER
sudo reboot
```

### 2. ë„ì»¤ê¸°ë³¸ëª…ë ¹

```bash
# í„°ë¯¸ë„ì—ì„œ ì…ë ¥í•œ í…ìŠ¤íŠ¸ë¥¼ ë§í’ì„ ê³¼ í•¨ê»˜ ASCII ì•„íŠ¸ ì†Œ(cow)ê°€ ë§í•˜ëŠ” ê²ƒì²˜ëŸ¼ ì¶œë ¥ìœ í‹¸ë¦¬í‹°
# ì£¼ë¡œ ì¥ë‚œì´ë‚˜ ì¬ë¯¸ìš©ìœ¼ë¡œ ì‚¬ìš©
sudo apt install -y cowsay

# docker/whalesayëŠ” deprecated
# docker run docker/whalesay cowsay 'hello world!'

# `-d` ì˜µì…˜ ì¶”ê°€
docker run -d nginx

# exec ëª…ë ¹ìœ¼ë¡œ nginxì»¨í…Œì´ë„ˆì— wget ì„¤ì¹˜ localhostë¡œ ìš”ì²­
docker exec <container-id> sh -c 'apt update && apt install -y wget'
```
ğŸ“‹ docker run Options
| ì˜µì…˜                    | ì„¤ëª…                                                                    |
| --------------------- | --------------------------------------------------------------------- |
| `-d`                  | Detached ëª¨ë“œ (ë°±ê·¸ë¼ìš´ë“œì—ì„œ ì‹¤í–‰)                                              |
| `-it`                 | ì¸í„°ë™í‹°ë¸Œ + TTY (í„°ë¯¸ë„ ì…ë ¥ ê°€ëŠ¥, ì£¼ë¡œ ì…¸ìš©)                                        |
| `--rm`                | ì»¨í…Œì´ë„ˆ ì¢…ë£Œ ì‹œ ìë™ ì‚­ì œ                                                       |
| `--name <name>`       | ì»¨í…Œì´ë„ˆ ì´ë¦„ ì§€ì •                                                            |
| `-p <host:container>` | í¬íŠ¸ í¬ì›Œë”© ì„¤ì • (ì˜ˆ: `-p 8080:80`)                                           |
| `-e <key=value>`      | í™˜ê²½ë³€ìˆ˜ ì„¤ì • (ì˜ˆ: `-e ENV=prod`)                                            |
| `-v <host:container>` | ë³¼ë¥¨ ë§ˆìš´íŠ¸ (ì˜ˆ: `-v /host/data:/container/data`)                           |
| `--network <name>`    | ì‚¬ìš©ì ì •ì˜ ë„¤íŠ¸ì›Œí¬ ì—°ê²°                                                        |
| `--restart <policy>`  | ì»¨í…Œì´ë„ˆ ì¬ì‹œì‘ ì •ì±… ì„¤ì •<br>(ì˜ˆ: `no`, `on-failure`, `always`, `unless-stopped`) |
| `--entrypoint <cmd>`  | ê¸°ë³¸ ENTRYPOINT ë¬´ì‹œí•˜ê³  ë‹¤ë¥¸ ëª…ë ¹ì–´ ì‹¤í–‰                                          |
| `--privileged`        | íŠ¹ê¶Œ ëª¨ë“œë¡œ ì‹¤í–‰ (í˜¸ìŠ¤íŠ¸ ìì›ì— ë” ë§ì€ ì ‘ê·¼ í—ˆìš©)                                        |


ğŸ” ìƒì„¸ ì„¤ëª…
| êµ¬ì„± ìš”ì†Œ                                 | ì˜ë¯¸                               |
| ------------------------------------- | -------------------------------- |
| `docker exec`                         | ì‹¤í–‰ ì¤‘ì¸ ì»¨í…Œì´ë„ˆ ë‚´ì—ì„œ ëª…ë ¹ì–´ë¥¼ ì‹¤í–‰í•©ë‹ˆë‹¤.       |
| `3e0cada80e4a`                        | ëŒ€ìƒ ì»¨í…Œì´ë„ˆì˜ ID ë˜ëŠ” ì´ë¦„ì…ë‹ˆë‹¤. (ì—¬ê¸°ì„  ID)   |
| `sh -c '...'`                         | ì…¸ì„ í†µí•´ ì—¬ëŸ¬ ëª…ë ¹ì„ í•œ ë²ˆì— ì‹¤í–‰í•  ìˆ˜ ìˆë„ë¡ í•©ë‹ˆë‹¤. |
| `'apt update && apt install -y wget'` | ì»¨í…Œì´ë„ˆ ë‚´ë¶€ì—ì„œ ì‹¤í–‰í•  ì‹¤ì œ ëª…ë ¹ì…ë‹ˆë‹¤.          |

âš™ï¸ docker exec ì£¼ìš” ì˜µì…˜ ì •ë¦¬
| ì˜µì…˜                    | ì„¤ëª…                           | ì˜ˆì‹œ                          |
| --------------------- | ---------------------------- | --------------------------- |
| `-i`, `--interactive` | í‘œì¤€ ì…ë ¥(STDIN)ì„ ìœ ì§€             | `-i`                        |
| `-t`, `--tty`         | TTY ê°€ìƒ í„°ë¯¸ë„ í• ë‹¹ (í„°ë¯¸ë„ ì¶œë ¥ í¬ë§· ìœ ì§€) | `-t`                        |
| `-u`, `--user`        | ëª…ë ¹ì„ ì‹¤í–‰í•  ì‚¬ìš©ì ì§€ì •               | `-u root` ë˜ëŠ” `-u 1000:1000` |
| `-e`, `--env`         | í™˜ê²½ë³€ìˆ˜ ì„¤ì •                      | `-e DEBUG=true`             |
| `--privileged`        | íŠ¹ê¶Œ ê¶Œí•œìœ¼ë¡œ ì‹¤í–‰ (í˜¸ìŠ¤íŠ¸ ìì› ì ‘ê·¼ í™•ëŒ€)    | `--privileged`              |
| `--workdir`, `-w`     | ëª…ë ¹ì–´ë¥¼ ì‹¤í–‰í•  ì‘ì—… ë””ë ‰í† ë¦¬ ì„¤ì •          | `-w /app`                   |
| `--detach`, `-d`      | ëª…ë ¹ì–´ë¥¼ ë°±ê·¸ë¼ìš´ë“œì—ì„œ ì‹¤í–‰              | `-d`                        |
| `--detach-keys`       | ë°±ê·¸ë¼ìš´ë“œ ì „í™˜ ë‹¨ì¶•í‚¤ ë³€ê²½              | `--detach-keys="ctrl-e,e"`  |


```bash
docker exec <container-id> wget localhost
# ì¶œë ¥ê²°ê³¼
# --2025-07-02 05:10:45--  http://localhost/
# Resolving localhost (localhost)... ::1, 127.0.0.1
# Connecting to localhost (localhost)|::1|:80... connected.
# HTTP request sent, awaiting response... 200 OK
# Length: 615 [text/html]
# Saving to: 'index.html'

#      0K                                                       100%  154M=0s

# 2025-07-02 05:10:45 (154 MB/s) - 'index.html' saved [615/615]
``` 
<hr>

## B. docker ubuntu imageì—ì„œ ì‹¤ìŠµí•  ê²½ìš°
### dockerì´ë¯¸ì§€ ì•ˆì—ì„œ docker ì´ë¯¸ì§€ë¥¼ ì‚¬ìš©í•˜ëŠ” ê²ƒìœ¼ë¡œ ì£¼ì˜ì‚¬í•­
>âœ… Docker-in-Dockerë¥¼ ì‚¬ìš©í•˜ëŠ” ê²ƒì´ ì ì ˆí•œ ê²½ìš°
>CI/CD íŒŒì´í”„ë¼ì¸
>GitLab CIì™€ ê°™ì€ CI ë„êµ¬ì—ì„œ Docker ì´ë¯¸ì§€ë¥¼ ë¹Œë“œí•˜ê³  í‘¸ì‹œí•´ì•¼ í•  ë•Œ ì¢…ì¢… DinDê°€ ì‚¬ìš©ë©ë‹ˆë‹¤.
>
>ì™„ì „í•œ ê²©ë¦¬ í™˜ê²½ì´ í•„ìš”í•œ ê²½ìš°
>Docker ìì²´ë¥¼ í…ŒìŠ¤íŠ¸í•˜ê±°ë‚˜ ì»¨í…Œì´ë„ˆ ì•ˆì—ì„œ ë˜ ë‹¤ë¥¸ ì»¨í…Œì´ë„ˆ í™˜ê²½ì„ ì™„ì „íˆ ê²©ë¦¬í•˜ì—¬ ì‹¤í–‰í•´ì•¼ í•˜
>
>âš ï¸ ì£¼ì˜í•  ì  ë° ë‹¨ì 
>ë³´ì•ˆ ìœ„í—˜
>DinDëŠ” ì»¨í…Œì´ë„ˆê°€ Docker ë°ëª¬ì„ í†µí•´ í˜¸ìŠ¤íŠ¸ ì»¤ë„ì— ì ‘ê·¼í•  ìˆ˜ ìˆê²Œ ë˜ì–´ ë³´ì•ˆìƒ ì·¨ì•½í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤. >ì»¨í…Œì´ë„ˆ ê²©ë¦¬ ì›ì¹™ì„ ê¹¨ëœ¨ë¦´ ìˆ˜ ìˆìŠµë‹ˆë‹¤.
>
>ë³µì¡ì„± ì¦ê°€ ë° ë¶ˆì•ˆì •ì„±
>ì»¨í…Œì´ë„ˆ ì•ˆì—ì„œ Docker ë°ëª¬ì„ ì‹¤í–‰í•˜ë©´ ë„¤íŠ¸ì›Œí¬ ì„¤ì •, ë³¼ë¥¨ ë§ˆìš´íŠ¸ ë“±ì—ì„œ ì˜ˆê¸°ì¹˜ ëª»í•œ ë¬¸ì œë‚˜ ë²„ê·¸ê°€ >ë°œìƒí•  ìˆ˜ ìˆìŠµë‹ˆë‹¤

* Ubuntu ê³µì‹ ì´ë¯¸ì§€ëŠ” ê¸°ë³¸ì ìœ¼ë¡œ systemdë¡œ ë¶€íŒ…ë˜ì§€ ì•Šìœ¼ë¯€ë¡œ, ì»¨í…Œì´ë„ˆ ë‚´ì—ì„œ ì§ì ‘ systemdë¥¼ PID 1ë¡œ ì‹¤í–‰í•´ì•¼ í•©ë‹ˆë‹¤.
* bash ì„¸ì…˜ì—ì„œëŠ” systemdë¥¼ ë°”ë¡œ ì‹¤í–‰í•´ë„ ì •ìƒ ë™ì‘í•˜ì§€ ì•ŠìŠµë‹ˆë‹¤.
* ì»¨í…Œì´ë„ˆë¥¼ ì¢…ë£Œí•˜ê³ , systemdë¡œ ì¬ì‹¤í–‰
* ì»¨í…Œì´ë„ˆë¥¼ ë‚˜ì™€ì„œ(ì¢…ë£Œ: exit), ì•„ë˜ì²˜ëŸ¼ systemdë¥¼ PID 1ë¡œ ì‹¤í–‰í•©ë‹ˆë‹¤.

### ë°©ë²•1. systemdë¥¼ ì„¤ì¹˜í•œ docker imageë¥¼ ì‚¬ìš©í•  ê²½ìš°
```bash
# 1. hostì—ì„œ ì‹¤í–‰
# systemd ì‹¤í–‰ì„ ìœ„í•œ ì˜¬ë°”ë¥¸ ì˜µì…˜ìœ¼ë¡œ ì»¨í…Œì´ë„ˆ ì‹¤í–‰
docker run -d --name myubuntu `
  --privileged `
  --tmpfs /tmp `
  --tmpfs /run `
  --tmpfs /run/lock `
  -v /sys/fs/cgroup:/sys/fs/cgroup:rw `
  --cgroupns=host `
  jrei/systemd-ubuntu:latest

docker exec -it 9129 /bin/bash

# 2. ì»¨í…Œì´ë„ˆì—ì„œ ì‹¤í–‰
$ ps -aux
$ apt update && apt install -y docker.io net-tools
$ systemctl start docker
$ docker ps -a
$ exit
```

### ë°©ë²•2. (ê¶Œì¥) systemdë¥¼ ì„¤ì¹˜í•˜ì§€ ì•Šì€ docker imageë¥¼ ì‚¬ìš©í•  ê²½ìš°
```bash
# 1. hostì—ì„œ ì‹¤í–‰
# ê¸°ì¡´ ì»¨í…Œì´ë„ˆ ì‚­ì œ
docker rm -f myubuntu

# ê°„ë‹¨í•œ Ubuntu ì»¨í…Œì´ë„ˆ ì‹¤í–‰
docker run -d --name myubuntu --privileged ubuntu:latest sleep infinity

# ì»¨í…Œì´ë„ˆ ì ‘ì†
docker exec -it myubuntu /bin/bash

# 2. ì»¨í…Œì´ë„ˆì—ì„œ ì‹¤í–‰
# í•„ìš”í•œ íŒ¨í‚¤ì§€ ì„¤ì¹˜
$ apt update && apt upgrade -y
$ apt install -y sudo curl wget gnupg lsb-release

# Docker ì„¤ì¹˜
$ curl -fsSL https://download.docker.com/linux/ubuntu/gpg | gpg --dearmor -o /usr/share/keyrings/docker-archive-keyring.gpg
$ echo "deb [arch=$(dpkg --print-architecture) signed-by=/usr/share/keyrings/docker-archive-keyring.gpg] https://download.docker.com/linux/ubuntu $(lsb_release -cs) stable" | tee /etc/apt/sources.list.d/docker.list > /dev/null
$ apt update && apt install -y docker-ce docker-ce-cli containerd.io
$ docker -version

# Docker ë°ëª¬ ë°±ê·¸ë¼ìš´ë“œ ì‹¤í–‰
$ dockerd &
```

### C. ì‹¤ìŠµ - WSLê³¼ ubuntu(vmware)

#### 1. nginx ì»¨í…Œì´ë„ˆ ì‹¤í–‰
```bash
# host
docker run -d --name my-nginx nginx
docker exec -it my-nginx /bin/bash

# container
ls -al
exit

# host
# hostì—ì„œ ì»¨í…Œì´ë„ˆë¡œ ë³µì‚¬
docker cp /etc/passwd my-nginx:/usr/share/nginx/html
docker exec -it my-nginx ls /usr/share/nginx/html
```

#### 2. Dockerfile

* Dockerfile-ch01
```Dockerfile
# Dockerfile
FROM ubuntu:20.04

RUN apt-get update \
    && apt-get install -y \
      curl \
      python-dev

WORKDIR /root
COPY hello.py .
# ENV my_ver=1.0

# 1. ARGë¡œ ë¹Œë“œ ì¸ì ì„ ì–¸ (ê¸°ë³¸ê°’ ì¶”ê°€ ê°€ëŠ¥)
# --build-argë¡œ ë®ì–´ì“¸ ìˆ˜ ìˆìŒ
ARG my_ver=1.0  

# 2. ARG ê°’ì„ ENVë¡œ ì „í™˜ (ë°˜ë“œì‹œ í•„ìš”)
ENV my_ver=$my_ver

CMD ["python", "hello.py", "guest"]
```

* hello.py
```python
import os
import sys

my_ver = os.environ["my_ver"]
arg = sys.argv[1]

print("hello %s, my version is %s!" % (arg, my_ver))
```

#### 3. Dockerfile - ë³€ìˆ˜ì„¤ì •
```bash
docker build -t myimage:01 -f ./Dockerfile-ch01 .
docker run myimage:01
# ì¶œë ¥ê²°ê³¼) hello guest, my version is 1.0!

# --build-arg my_ver=2.0	ë¹Œë“œ ì‹œ ë³€ìˆ˜(my_ver) ì „ë‹¬
# Dockerfile ìˆ˜ì • : ENV my_ver $my_ver
docker build -t myimage:01 --build-arg my_ver=2.0 -f ./Dockerfile-ch01 .
docker run myimage:01

# -eë³€ìˆ˜ëŠ” ì´ë¯¸ì§€ë³´ë‹¤ ì•ì— ìœ„ì¹˜í•´ì•¼ í•œë‹¤.
docker run -e my_ver=3.0 myimage:01
```

#### 4. Dockerfile - CMD vs ENTRYPOINT

#### âœ… CMD vs ENTRYPOINT ë¹„êµí‘œ
| í•­ëª©        | `CMD`                               | `ENTRYPOINT`                             |
| --------- | ----------------------------------- | ---------------------------------------- |
| ì—­í•         | ê¸°ë³¸ ëª…ë ¹ì–´ì™€ ì¸ì ì§€ì • (ì˜µì…˜ì ìœ¼ë¡œ ì‹¤í–‰)            | ì»¨í…Œì´ë„ˆê°€ ì‹¤í–‰ë  ë•Œ ë°˜ë“œì‹œ ì‹¤í–‰í•  ëª…ë ¹ ì§€ì •                |
| ë®ì–´ì“°ê¸°      | `docker run`ì—ì„œ **ëª…ë ¹ì–´ë¥¼ ì…ë ¥í•˜ë©´ ë®ì–´ì¨ì§**   | `ENTRYPOINT`ëŠ” ìœ ì§€ë˜ê³ , ì¸ìë§Œ ì¶”ê°€ë¨              |
| ì‹¤í–‰ ë°©ì‹     | **ëª…ë ¹ ì „ì²´ë¥¼ ë®ì–´ì”€** (`CMD`ê°€ ë¬´ì‹œë¨)         | `ENTRYPOINT` + `docker run`ì— ì§€ì •í•œ ì¸ìê°€ ê²°í•©ë¨ |
| í˜•ì‹        | shell ë˜ëŠ” exec í˜•ì‹ ê°€ëŠ¥                 | shell ë˜ëŠ” exec í˜•ì‹ ê°€ëŠ¥                      |
| í•¨ê»˜ ì‚¬ìš© ê°€ëŠ¥? | `ENTRYPOINT`ì™€ í•¨ê»˜ ì‚¬ìš©í•˜ë©´, `CMD`ëŠ” ì¸ì ì—­í•  | `ENTRYPOINT`ê°€ ëª…ë ¹, `CMD`ëŠ” ê¸°ë³¸ ì¸ìì²˜ëŸ¼ ì‘ë™      |

#### ğŸ§ª ì˜ˆì œ ë¹„êµ
##### 1. CMDë§Œ ì‚¬ìš©
````Dockerfile

FROM ubuntu
CMD ["echo", "Hello from CMD"]
```

```bash
docker build -t cmd-example .
docker run cmd-example
# ì¶œë ¥: Hello from CMD

docker run cmd-example echo "Overridden"
# ì¶œë ¥: Overridden (CMDëŠ” ì™„ì „íˆ ë®ì–´ì”€)
```

##### 2. ENTRYPOINTë§Œ ì‚¬ìš©
```Dockerfile
FROM ubuntu
ENTRYPOINT ["echo", "Hello from ENTRYPOINT"]
```

```bash
docker run entrypoint-example
# ì¶œë ¥: Hello from ENTRYPOINT

docker run entrypoint-example "again!"
# ì¶œë ¥: Hello from ENTRYPOINT again! (ì¸ìë§Œ ë§ë¶™ìŒ)
```

##### 3. ENTRYPOINT + CMD ê°™ì´ ì‚¬ìš©
```Dockerfile
FROM ubuntu
ENTRYPOINT ["echo"]
CMD ["Hello from both"]
```

```bash
docker run entry-cmd-example
# ì¶œë ¥: Hello from both

docker run entry-cmd-example "Custom Message"
# ì¶œë ¥: Custom Message
```

#### âœ… ì–´ë–¤ ê±¸ ì¨ì•¼ í• ê¹Œ?
| ìƒí™©                      | ì¶”ì²œ ë°©ì‹                |
| ----------------------- | -------------------- |
| ê¸°ë³¸ ëª…ë ¹ì€ ìˆê³ , ì‚¬ìš©ì ë®ì–´ì“°ê¸° í—ˆìš©  | `CMD`                |
| í•­ìƒ ì‹¤í–‰ë˜ì–´ì•¼ í•˜ëŠ” ê³ ì • ëª…ë ¹ì´ ìˆì„ ë•Œ | `ENTRYPOINT`         |
| ê³ ì • ëª…ë ¹ + ì¸ìëŠ” ì˜µì…˜ì¼ ë•Œ       | `ENTRYPOINT` + `CMD` |


####  ì •ë¦¬ ìš”ì•½
* CMD: ê¸°ë³¸ê°’ ëª…ë ¹ì–´ (ë®ì–´ì“°ê¸° ì‰¬ì›€)
* ENTRYPOINT: ê³ ì • ëª…ë ¹ì–´ (ë®ì–´ì“°ê¸° ì–´ë µê³  ì˜ë„í•œ ëª…ë ¹ ìœ ì§€ë¨)
* ë‘˜ì„ ê°™ì´ ì“°ë©´: ENTRYPOINTëŠ” ëª…ë ¹, CMDëŠ” ì¸ì

* Dockerfile-ch01
```Dockerfile
# Dockerfile
FROM ubuntu:20.04

RUN apt-get update \
    && apt-get install -y \
      curl \
      python-dev

WORKDIR /root
COPY hello.py .
ENV my_ver=1.0

# CMD ["python", "hello.py", "guest"]
ENTRYPOINT ["python", "hello.py", "guest"]

```bash
docker build -t myimage:02 -f ./Dockerfile-ch01 .
docker run myimage:02

# ENTRYPOINT ì‹¤í–‰ëª…ë ¹ì´ ì˜¤ë²„ë¼ì´ë”©ë˜ì§€ ì•ŠëŠ”ë‹¤!
docker run myimage:02 echo "hello~~~"

# ENTRYPOINT "guest" ì‚­ì œí›„ ì‹¤í–‰
# ENTRYPOINT ["python", "hello.py"]
docker build -t myimage:03 -f ./Dockerfile-ch01 .

# íŒŒë¼ë¯¸í„°ì „ë‹¬
docker run myimage:03 new-guest
# ì¶œë ¥ê²°ê³¼) hello new-guest, my version is 1.0!

# entrypointë¥¼ cat ëª…ë ¹ìœ¼ë¡œ override
docker build -t myimage:04 -f ./Dockerfile-ch01 .
docker run --entrypoint=cat myimage:04 /etc/passwd
```

#### 5. Network

```bash
docker run -p 5000:80 -d nginx
curl localhost:5000
```

#### 6. Volume
```bash
# í˜„ì¬ ë””ë ‰í† ë¦¬ë¥¼ ì»¨í…Œì´ë„ˆì˜ nginx ë””ë ‰í† ë¦¬ì™€ ì—°ê²°í•©ë‹ˆë‹¤.
docker run -p 6000:80 -v $(pwd):/usr/share/nginx/html/ -d nginx
echo hello! >> $(pwd)/hello.txt
docker exec -it <ì»¨í…Œì´ë„ˆëª… or id> ls /usr/share/nginx/html/  
curl localhost:6000/hello.txt
# hello!

docker exec -it <ì»¨í…Œì´ë„ˆëª… or id> cat /usr/share/nginx/html/hello.txt  
docker exec -it cool_chebyshev  cat /usr/share/nginx/html/hello.txt  
```

#### 7. User

##### Dockerfile-ch01-user
```Dockerfile
# Dockerfile
FROM ubuntu:18.04

# Ubuntu ìœ ì € ìƒì„±
RUN adduser --disabled-password --gecos "" ubuntu

# ì»¨í…Œì´ë„ˆ ì‹¤í–‰ ì‹œ ubuntu ìœ ì €ë¡œ ì„¤ì •
USER ubuntu
``` 

```bash
# myuser:01 ë¼ëŠ” ì´ë¯¸ì§€ ìƒì„±
docker build -t myuser:01 -f ./Dockerfile-ch01-user . 

# ubuntuë¼ëŠ” ìœ ì €ë¡œ ì»¨í…Œì´ë„ˆ ì‹¤í–‰
docker run -it myuser:01 /bin/bash

# ì»¨í…Œì´ë„ˆ
ubuntu@6edea530a7ad:/$ 
ubuntu@6edea530a7ad:/$ apt update 
# Reading package lists... Done
# E: List directory /var/lib/apt/lists/partial is missing.
# - Acquire (13: Permission denied)
ubuntu@6edea530a7ad:/$ exit

# ê°•ì œë¡œ root ìœ ì € ì‚¬ìš©
docker run --user root -it myuser:01 /bin/bash
root@462bcbd650a1:/#
root@462bcbd650a1:/# apt update
root@462bcbd650a1:/# exit

# cleanup

docker rm $(docker ps -aq) -f
docker rmi $(docker images -q) -f
docker volume rm <volume_name>
docker volume ls
```
